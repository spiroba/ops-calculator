<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üí∞ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ü—Ä–µ–º–∏–π –û–ü–°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 1200px;
            margin: 0 auto;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .warning-critical {
            background: linear-gradient(135deg, #ff4757 0%, #ff3838 100%);
            color: white;
            padding: 15px;
            margin: 20px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            display: none;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .main-content {
            padding: 30px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .left-panel, .right-panel {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #2d3748;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .position-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .position-option {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .position-option:hover {
            border-color: #4facfe;
            transform: translateY(-2px);
        }

        .position-option.active {
            border-color: #4facfe;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .position-option input {
            display: none;
        }

        .position-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .position-name {
            font-weight: 600;
            font-size: 0.95rem;
        }

        .operations-grid, .kpi-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .operation-item, .kpi-item {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .operation-item:hover, .kpi-item:hover {
            border-color: #4facfe;
            transform: translateY(-1px);
        }

        .operation-label, .kpi-label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2d3748;
            font-size: 0.9rem;
        }

        .operation-rate {
            font-size: 0.8rem;
            color: #718096;
            margin-bottom: 10px;
        }

        .operation-input, .kpi-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .kpi-inputs {
            display: flex;
            gap: 8px;
        }

        .kpi-input {
            flex: 1;
            padding: 8px;
            font-size: 0.85rem;
        }

        .results {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 15px;
            padding: 25px;
            min-height: 300px;
        }

        .results-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 20px;
            text-align: center;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255,255,255,0.3);
        }

        .result-item:last-child {
            border-bottom: none;
            font-weight: 700;
            font-size: 1.2rem;
            background: rgba(255,255,255,0.4);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .calculate-btn {
            width: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s ease;
            margin-top: 20px;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
        }

        .version {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 20px;
            }
            
            .operations-grid, .kpi-grid {
                grid-template-columns: 1fr;
            }
            
            .position-selector {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí∞ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ü—Ä–µ–º–∏–π –û–ü–°*</h1>
            <p style="font-size: 0.9rem; color: #666; margin-top: 10px; font-style: italic;">
                * –†–∞—Å—á–µ—Ç –Ω–æ—Å–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏ –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–µ–º–∏–∏
            </p>
        </div>
        
        <div class="warning-critical" id="warningCritical">
            ‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï! –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø–ª–∞–Ω–∞ –≤—ã—Ä—É—á–∫–∏ –º–µ–Ω–µ–µ 80% –ö–ü–ò-–±–æ–Ω—É—Å—ã –æ–±–Ω—É–ª—è—é—Ç—Å—è! (–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã –æ—Å—Ç–∞—é—Ç—Å—è)
        </div>

        <div class="main-content">
            <div class="left-panel">
                <div class="section">
                    <div class="section-title">üë• –í—ã–±–æ—Ä –¥–æ–ª–∂–Ω–æ—Å—Ç–∏</div>
                    <div class="position-selector">
                        <label class="position-option active" for="operator">
                            <input type="radio" id="operator" name="position" value="operator" checked>
                            <div class="position-icon">üë®‚Äçüíº</div>
                            <div class="position-name">–û–ø–µ—Ä–∞—Ç–æ—Ä</div>
                        </label>
                        <label class="position-option" for="nops_operational">
                            <input type="radio" id="nops_operational" name="position" value="nops_operational">
                            <div class="position-icon">üë®‚Äçüíª</div>
                            <div class="position-name">–ù–û–ü–° (–±–µ–∑ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤)</div>
                        </label>
                        <label class="position-option" for="nops_management">
                            <input type="radio" id="nops_management" name="position" value="nops_management">
                            <div class="position-icon">üë®‚Äçüíº</div>
                            <div class="position-name">–ù–û–ü–° (—Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏)</div>
                        </label>
                        <label class="position-option" for="admin">
                            <input type="radio" id="admin" name="position" value="admin">
                            <div class="position-icon">üë®‚Äçüíº</div>
                            <div class="position-name">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</div>
                        </label>
                        <label class="position-option" for="postman">
                            <input type="radio" id="postman" name="position" value="postman">
                            <div class="position-icon">üö∂‚Äç‚ôÇÔ∏è</div>
                            <div class="position-name">–ü–æ—á—Ç–∞–ª—å–æ–Ω</div>
                        </label>
                        <label class="position-option" for="chief_specialist">
                            <input type="radio" id="chief_specialist" name="position" value="chief_specialist">
                            <div class="position-icon">üë®‚Äçüîß</div>
                            <div class="position-name">–ì–ª–∞–≤–Ω—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç</div>
                        </label>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">üíº –û–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥</div>
                    <div class="operations-grid" id="operationsGrid"></div>
                </div>
            </div>

            <div class="right-panel">
                <div class="section" id="kpiSection">
                    <div class="section-title">üìä –ö–ü–ò –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</div>
                    <div class="kpi-grid" id="kpiGrid"></div>
                </div>

                <div class="section" id="coefficientsSection">
                    <div class="section-title" id="coefficientsTitle">‚öôÔ∏è –ö–æ–º–∞–Ω–¥–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã</div>
                    <div class="kpi-grid" id="coefficientsGrid"></div>
                </div>

                <div class="results">
                    <div class="results-title">üìä –†–∞—Å—á–µ—Ç –ø—Ä–µ–º–∏–∏:</div>
                    <div id="resultsContent">
                        <p style="text-align: center; color: #718096; margin-top: 50px;">
                            –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–∞–∂–º–∏—Ç–µ "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø—Ä–µ–º–∏—é"
                        </p>
                    </div>
                </div>

                <button class="calculate-btn" onclick="calculatePremium()">
                    üöÄ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø—Ä–µ–º–∏—é
                </button>
            </div>
        </div>
    </div>

    <div class="version">v2.1 –ü–µ—Ä–µ–º–µ—â–µ–Ω –¥–∏—Å–∫–ª–µ–π–º–µ—Ä –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–æ–∫</div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π –∏ –æ–ø–µ—Ä–∞—Ü–∏–π
        const POSITIONS_CONFIG = {
            operator: {
                name: "–û–ø–µ—Ä–∞—Ç–æ—Ä 1-3 –∫–ª–∞—Å—Å–∞",
                operations: [1, 3, 4, 5, 6, 7, 10, 11, 12, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24], // –ò–°–ü–†–ê–í–õ–ï–ù–û: –¥–æ–±–∞–≤–∏–ª 10(–º—É–ª—å—Ç–∏–ø–æ–¥–ø–∏—Å—å), 22(–≤—Ä—É—á–µ–Ω–∏–µ E–ö–û–ú)
                kpi: [], // –£ –æ–±—ã—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –ù–ï–¢ –ö–ü–ò
                teamCoefficients: ["service", "speed_reception", "speed_delivery", "efficiency"], // –í—Å–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
                hasTeamBonus: false
            },
            nops_operational: {
                name: "–ù–û–ü–° –±–µ–∑ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ (—Å–∞–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏)",
                operations: [1, 3, 4, 5, 6, 7, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 23, 24, 25], // –ò–°–ü–†–ê–í–õ–ï–ù–û: –¥–æ–±–∞–≤–∏–ª 10(–º—É–ª—å—Ç–∏–ø–æ–¥–ø–∏—Å—å), 22(–≤—Ä—É—á–µ–Ω–∏–µ E–ö–û–ú)
                kpi: ["revenue", "csi", "online_rpo", "co1_co2"],
                teamCoefficients: [], // –ö–ü–ò —Å–∏—Å—Ç–µ–º–∞ –≤–º–µ—Å—Ç–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
                hasTeamBonus: false // –ù–µ –ø–æ–ª—É—á–∞–µ—Ç % –æ—Ç –¥—Ä—É–≥–∏—Ö, —Å–∞–º —Ä–∞–±–æ—Ç–∞–µ—Ç
            },
            nops_management: {
                name: "–ù–û–ü–° —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ (—Ç–æ–ª—å–∫–æ —Ä—É–∫–æ–≤–æ–¥—è—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏)",
                operations: [10, 11, 13, 14, 25], // –ò–°–ü–†–ê–í–õ–ï–ù–û: –¥–æ–±–∞–≤–∏–ª 11(–ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –ø–µ–Ω—Å–∏–æ–Ω–µ—Ä–∞)
                kpi: ["revenue", "csi", "online_rpo", "co1_co2"],
                teamCoefficients: [], // –ö–ü–ò —Å–∏—Å—Ç–µ–º–∞ –≤–º–µ—Å—Ç–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
                hasTeamBonus: true, // –ü–æ–ª—É—á–∞–µ—Ç % –æ—Ç –ø—Ä–µ–º–∏–π –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã—Ö
                isManagementOnly: true // –¢–æ–ª—å–∫–æ —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
            },
            admin: {
                name: "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä",
                operations: [3, 11, 16], // –ò–°–ü–†–ê–í–õ–ï–ù–û: —É–±—Ä–∞–ª 10(–º—É–ª—å—Ç–∏–ø–æ–¥–ø–∏—Å—å) - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç
                kpi: ["revenue", "csi", "online_rpo"],
                teamCoefficients: ["service", "speed_reception", "speed_delivery"], // –ë–µ–∑ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–µ—Å—Ç—å –ö–ü–ò)
                hasTeamBonus: false
            },
            postman: {
                name: "–ü–æ—á—Ç–∞–ª—å–æ–Ω",
                operations: [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 25], // –ò–°–ü–†–ê–í–õ–ï–ù–û: –¥–æ–±–∞–≤–∏–ª 10(–º—É–ª—å—Ç–∏–ø–æ–¥–ø–∏—Å—å)
                kpi: [], // –£ –ø–æ—á—Ç–∞–ª—å–æ–Ω–∞ –ù–ï–¢ –ö–ü–ò
                teamCoefficients: ["service", "efficiency"], // –°–µ—Ä–≤–∏—Å + —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–Ω–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π —Ç–∏–ø–∞ 3-4)
                hasTeamBonus: false
            },
            chief_specialist: {
                name: "–ì–ª–∞–≤–Ω—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—é –ø–æ—á—Ç–æ–≤–æ–π —Å–≤—è–∑–∏",
                operations: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25], // –í–°–ï 25 –æ–ø–µ—Ä–∞—Ü–∏–π
                kpi: [], // –£ –≥–ª–∞–≤–Ω–æ–≥–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –ù–ï–¢ –ö–ü–ò
                teamCoefficients: ["service", "speed_reception", "speed_delivery", "efficiency"], // –í—Å–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
                hasTeamBonus: false
            }
        };

        const OPERATIONS_CONFIG = {
            1: { name: "–†–æ–∑–Ω–∏—Ü–∞ (—Ç–æ–≤–∞—Ä—ã)", rate: "3% –æ—Ç —Å—É–º–º—ã", type: "percent", value: 0.03, unit: "‚ÇΩ", operationType: 2 },
            2: { name: "–†–æ–∑–Ω–∏—Ü–∞ 16 –î–ü", rate: "5% –æ—Ç —Å—É–º–º—ã", type: "percent", value: 0.05, unit: "‚ÇΩ", operationType: 2 },
            3: { name: "–õ–æ—Ç–µ—Ä–µ–π–Ω—ã–µ –±–∏–ª–µ—Ç—ã", rate: "3% –æ—Ç —Å—É–º–º—ã", type: "percent", value: 0.03, unit: "‚ÇΩ", operationType: 2 },
            4: { name: "–ü–æ–¥–ø–∏—Å–∫–∞", rate: "2% –æ—Ç —Å—É–º–º—ã", type: "percent", value: 0.02, unit: "‚ÇΩ", operationType: 2 },
            5: { name: "–°–∏–º-–∫–∞—Ä—Ç–∞ —Ç–∏–ø 1", rate: "50‚ÇΩ/—à—Ç", type: "fixed", value: 50, unit: "—à—Ç", operationType: 2 },
            6: { name: "–°–∏–º-–∫–∞—Ä—Ç–∞ —Ç–∏–ø 2", rate: "30‚ÇΩ/—à—Ç", type: "fixed", value: 30, unit: "—à—Ç", operationType: 2 },
            7: { name: "–°–∏–º-–∫–∞—Ä—Ç–∞ —Ç–∏–ø 3", rate: "10‚ÇΩ/—à—Ç", type: "fixed", value: 10, unit: "—à—Ç", operationType: 2 },
            8: { name: "–î–æ—Å—Ç–∞–≤–∫–∞ –≥–∏–ø–µ—Ä–ª–æ–∫–∞", rate: "50‚ÇΩ/—à—Ç", type: "fixed", value: 50, unit: "—à—Ç", operationType: 2 },
            9: { name: "–ü–ª–∞—Ç–µ–∂ —Å –ú–ü–ö–¢", rate: "3‚ÇΩ/—à—Ç", type: "fixed", value: 3, unit: "—à—Ç", operationType: 2 },
            10: { name: "–ú—É–ª—å—Ç–∏–ø–æ–¥–ø–∏—Å—å", rate: "30‚ÇΩ/—à—Ç", type: "fixed", value: 30, unit: "—à—Ç", operationType: 2 },
            11: { name: "–ü—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –ø–µ–Ω—Å–∏–æ–Ω–µ—Ä–∞", rate: "300‚ÇΩ/—á–µ–ª", type: "fixed", value: 300, unit: "—á–µ–ª", operationType: 1 }, // –ò–°–ü–†–ê–í–õ–ï–ù–û: —Ç–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏ 1 –∏ 2 - —É–ø—Ä–æ—Å—Ç–∏–ª –¥–æ 1
            12: { name: "–í—ã–¥–∞—á–∞ WB", rate: "5‚ÇΩ/–∑–∞–∫–∞–∑", type: "fixed", value: 5, unit: "–∑–∞–∫–∞–∑", operationType: 1 }, // –ò–°–ü–†–ê–í–õ–ï–ù–û: —Ç–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏ 1 –∏ 2 - —É–ø—Ä–æ—Å—Ç–∏–ª –¥–æ 1
            13: { name: "–û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –ü–í–ó WB", rate: "—Å–ª–æ–∂–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞", type: "formula", value: 0, unit: "—É—Å–ª—É–≥–∞", operationType: 1 }, // –ò–°–ü–†–ê–í–õ–ï–ù–û: —Å–ª–æ–∂–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –ø–æ —Ç–∞–±–ª–∏—Ü–µ
            14: { name: "–í–æ–∑–≤—Ä–∞—Ç –∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å2—Å prof", rate: "1000‚ÇΩ/–∫–ª–∏–µ–Ω—Ç", type: "fixed", value: 1000, unit: "–∫–ª–∏–µ–Ω—Ç", operationType: 1 }, // –ò–°–ü–†–ê–í–õ–ï–ù–û: –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
            15: { name: "–ü—Ä–æ–¥–∞–∂–∞ EMS", rate: "40‚ÇΩ/—É—Å–ª—É–≥–∞", type: "fixed", value: 40, unit: "—É—Å–ª—É–≥–∞", operationType: 3 },
            16: { name: "–ü—Ä–∏–µ–º EMS –ø—Ä–µ–¥–æ–ø–ª–∞—á.", rate: "50‚ÇΩ/—à—Ç", type: "fixed", value: 50, unit: "—à—Ç", operationType: 3 },
            17: { name: "–ü—Ä–∏–µ–º –†–ü–û –ø–æ—Å—ã–ª–∫–∞", rate: "5‚ÇΩ/—à—Ç", type: "fixed", value: 5, unit: "—à—Ç", operationType: 3 },
            18: { name: "–ü—Ä–∏–µ–º –†–ü–û –ø–∏—Å—å–º–æ", rate: "0.5‚ÇΩ/—à—Ç", type: "fixed", value: 0.5, unit: "—à—Ç", operationType: 3 },
            19: { name: "–ü—Ä–∏–µ–º –ø—Ä–µ–¥–æ–ø–ª–∞—á. –†–ü–û –ø–æ—Å—ã–ª–∫–∞", rate: "7‚ÇΩ/—à—Ç", type: "fixed", value: 7, unit: "—à—Ç", operationType: 3 },
            20: { name: "–ü—Ä–∏–µ–º –ø—Ä–µ–¥–æ–ø–ª–∞—á. –†–ü–û –ø–∏—Å—å–º–æ", rate: "1‚ÇΩ/—à—Ç", type: "fixed", value: 1, unit: "—à—Ç", operationType: 3 },
            21: { name: "–í—Ä—É—á–µ–Ω–∏–µ –†–ü–û –ø–æ—Å—ã–ª–∫–∞", rate: "2‚ÇΩ/—à—Ç", type: "fixed", value: 2, unit: "—à—Ç", operationType: 4 },
            22: { name: "–í—Ä—É—á–µ–Ω–∏–µ E–ö–û–ú", rate: "0.5‚ÇΩ/—à—Ç", type: "fixed", value: 0.5, unit: "—à—Ç", operationType: 4 },
            23: { name: "–ü—Ä–∏–µ–º E–ö–û–ú", rate: "0.5‚ÇΩ/—à—Ç", type: "fixed", value: 0.5, unit: "—à—Ç", operationType: 3 },
            24: { name: "–ü—Ä–æ—á–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏", rate: "0.5‚ÇΩ/—à—Ç", type: "fixed", value: 0.5, unit: "—à—Ç", operationType: 2 },
            25: { name: "–£—á–∞—Å—Ç–∏–µ –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö", rate: "10‚ÇΩ (–ù–û–ü–°) / 13‚ÇΩ (–ø–æ—á—Ç–∞–ª—å–æ–Ω)", type: "fixed", value: 10, unit: "—É—Å–ª—É–≥–∞", operationType: 1 } // –ò–°–ü–†–ê–í–õ–ï–ù–û: –±–∞–∑–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞ 10‚ÇΩ
        };

        const KPI_CONFIG = {
            revenue: { name: "–ö–ü–ò –í—ã—Ä—É—á–∫–∞ –û–ü–°", placeholder: "% –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è", description: "80%+ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ö–ü–ò" },
            csi: { name: "–ö–ü–ò CSI –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å", placeholder: "% CSI", description: "–¢–∞–∫–∂–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –æ–ø–µ—Ä–∞—Ü–∏–π —Ç–∏–ø–∞ 2" },
            online_rpo: { name: "–ö–ü–ò –î–æ–ª—è –æ–Ω–ª–∞–π–Ω-–†–ü–û", placeholder: "% –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è" },
            co1_co2: { name: "–ö–ü–ò CO1/CO2", placeholder: "% –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è" }
        };

        const TEAM_COEFFICIENTS_CONFIG = {
            service: { 
                name: "–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –°–µ—Ä–≤–∏—Å (CSI)", 
                placeholder: "–ë–∞–ª–ª—ã CSI",
                description: "–í–ª–∏—è–µ—Ç –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç–∏–ø–∞ 2",
                type: "service"
            },
            speed_reception: { 
                name: "–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –°–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–∏–µ–º–∞", 
                placeholder: "% –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è",
                description: "–í–ª–∏—è–µ—Ç –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç–∏–ø–∞ 3",
                type: "speed_reception"
            },
            speed_delivery: { 
                name: "–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –°–∫–æ—Ä–æ—Å—Ç—å –≤—Ä—É—á–µ–Ω–∏—è", 
                placeholder: "% –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è",
                description: "–í–ª–∏—è–µ—Ç –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç–∏–ø–∞ 4",
                type: "speed_delivery"
            },
            efficiency: { 
                name: "–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –û–ü–°", 
                placeholder: "% –≤—ã—Ä—É—á–∫–∏",
                description: "–í–ª–∏—è–µ—Ç –Ω–∞ –∏—Ç–æ–≥–æ–≤—É—é –ø—Ä–µ–º–∏—é",
                type: "efficiency"
            }
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            initializePositionSelector();
            updateInterface();
        });

        function initializePositionSelector() {
            const positionInputs = document.querySelectorAll('input[name="position"]');
            positionInputs.forEach(input => {
                input.addEventListener('change', function() {
                    document.querySelectorAll('.position-option').forEach(option => {
                        option.classList.remove('active');
                    });
                    this.parentElement.classList.add('active');
                    updateInterface();
                });
            });
        }

        function updateInterface() {
            const selectedPosition = document.querySelector('input[name="position"]:checked').value;
            const config = POSITIONS_CONFIG[selectedPosition];
            
            updateOperationsGrid(config.operations);
            updateKPIGrid(config.kpi);
            updateTeamCoefficientsGrid(config.teamCoefficients || []);
            updateManagementFields(selectedPosition);
        }

        function updateOperationsGrid(allowedOperations) {
            const grid = document.getElementById('operationsGrid');
            grid.innerHTML = '';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
            allowedOperations.forEach(operationId => {
                const operation = OPERATIONS_CONFIG[operationId];
                
                const item = document.createElement('div');
                item.className = 'operation-item';
                item.innerHTML = `
                    <div class="operation-label">${operation.name}</div>
                    <div class="operation-rate">${operation.rate}</div>
                    <input type="number" 
                           class="operation-input" 
                           id="op_${operationId}"
                           placeholder="${operation.unit}"
                           min="0"
                           step="${operation.type === 'fixed' ? '1' : '0.01'}">
                `;
                grid.appendChild(item);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–∏–ø–∞—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è
            if (allowedOperations.length > 0) {
                const infoDiv = document.createElement('div');
                infoDiv.className = 'operation-info';
                infoDiv.style.cssText = 'margin-top: 15px; padding: 10px; background: #f0f8ff; border-radius: 8px; font-size: 0.9rem; color: #666;';
                
                const types = [...new Set(allowedOperations.map(id => OPERATIONS_CONFIG[id].operationType))].sort();
                const typeNames = {
                    1: '–¢–∏–ø 1 (–±–µ–∑ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤)',
                    2: '–¢–∏–ø 2 (√óK –°–µ—Ä–≤–∏—Å CSI)',
                    3: '–¢–∏–ø 3 (√óK –°–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–∏–µ–º–∞)',
                    4: '–¢–∏–ø 4 (√óK –°–∫–æ—Ä–æ—Å—Ç—å –≤—Ä—É—á–µ–Ω–∏—è)'
                };
                
                infoDiv.innerHTML = `
                    <strong>üí° –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∏–ø—ã –æ–ø–µ—Ä–∞—Ü–∏–π:</strong><br>
                    ${types.map(type => `‚Ä¢ ${typeNames[type]}`).join('<br>')}
                `;
                grid.appendChild(infoDiv);
            } else {
                // –î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–æ–≥–æ –ù–û–ü–° –±–µ–∑ –æ–ø–µ—Ä–∞—Ü–∏–π
                const infoDiv = document.createElement('div');
                infoDiv.className = 'operation-info';
                infoDiv.style.cssText = 'margin-top: 15px; padding: 10px; background: #fff3cd; border-radius: 8px; font-size: 0.9rem; color: #856404;';
                
                infoDiv.innerHTML = `
                    <strong>üë®‚Äçüíº –ù–û–ü–° —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏:</strong><br>
                    ‚Ä¢ –ù–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–∏—á–Ω–æ<br>
                    ‚Ä¢ –ü–æ–ª—É—á–∞–µ—Ç –ø—Ä–µ–º–∏—é –∑–∞ –ö–ü–ò<br>
                    ‚Ä¢ –ü–æ–ª—É—á–∞–µ—Ç 3% –æ—Ç –ø—Ä–µ–º–∏–π –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã—Ö<br>
                    ‚Ä¢ –í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –ø—Ä–µ–º–∏–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å–ø—Ä–∞–≤–∞
                `;
                grid.appendChild(infoDiv);
            }
        }

        function updateKPIGrid(allowedKPI) {
            const grid = document.getElementById('kpiGrid');
            const kpiSection = document.getElementById('kpiSection');
            
            grid.innerHTML = ''; // –û—á–∏—â–∞–µ–º grid –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤–µ—Å—å –±–ª–æ–∫ –ö–ü–ò –µ—Å–ª–∏ –Ω–µ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –¥–ª—è –¥–∞–Ω–Ω–æ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–∏
            if (allowedKPI.length === 0) {
                kpiSection.style.display = 'none';
                return;
            } else {
                kpiSection.style.display = 'block';
            }
            
            allowedKPI.forEach(kpiId => {
                const kpi = KPI_CONFIG[kpiId];
                
                const item = document.createElement('div');
                item.className = 'kpi-item';
                item.innerHTML = `
                    <div class="kpi-label">${kpi.name}</div>
                    ${kpi.description ? `<div class="operation-rate">${kpi.description}</div>` : ''}
                    <div class="kpi-inputs">
                        <input type="number" class="kpi-input" id="kpi_${kpiId}" placeholder="${kpi.placeholder}" min="0" step="0.1">
                    </div>
                `;
                grid.appendChild(item);
            });
        }

        function updateTeamCoefficientsGrid(allowedCoefficients) {
            const grid = document.getElementById('coefficientsGrid');
            const coefficientsSection = document.getElementById('coefficientsSection');
            
            grid.innerHTML = ''; // –û—á–∏—â–∞–µ–º grid –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            
            allowedCoefficients.forEach(coeffId => {
                const coeff = TEAM_COEFFICIENTS_CONFIG[coeffId];
                
                const item = document.createElement('div');
                item.className = 'kpi-item';
                item.innerHTML = `
                    <div class="kpi-label">${coeff.name}</div>
                    ${coeff.description ? `<div class="operation-rate">${coeff.description}</div>` : ''}
                    <div class="kpi-inputs">
                        <input type="number" class="kpi-input" id="coeff_${coeffId}" placeholder="${coeff.placeholder}" min="0" step="0.1">
                    </div>
                `;
                grid.appendChild(item);
            });
        }

        function updateManagementFields(selectedPosition) {
            const grid = document.getElementById('coefficientsGrid');
            const coefficientsSection = document.getElementById('coefficientsSection');
            const coefficientsTitle = document.getElementById('coefficientsTitle');
            const config = POSITIONS_CONFIG[selectedPosition];
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ –¥–ª—è —Å—É–º–º—ã –ø—Ä–µ–º–∏–π –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã—Ö –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–æ–≥–æ –ù–û–ü–°
            if (config.isManagementOnly) {
                const item = document.createElement('div');
                item.className = 'kpi-item';
                item.innerHTML = `
                    <div class="kpi-label">üí∞ –°—É–º–º–∞ –ø—Ä–µ–º–∏–π –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã—Ö</div>
                    <div class="operation-rate">3% –æ—Ç –æ–±—â–µ–π —Å—É–º–º—ã –ø—Ä–µ–º–∏–π –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã—Ö</div>
                    <div class="kpi-inputs">
                        <input type="number" class="kpi-input" id="subordinates_bonus" placeholder="–û–±—â–∞—è —Å—É–º–º–∞ ‚ÇΩ" min="0" step="0.01">
                    </div>
                `;
                grid.appendChild(item);
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤–µ—Å—å –±–ª–æ–∫ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç –Ω–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤, –Ω–∏ –ø–æ–ª—è –ø—Ä–µ–º–∏–π –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã—Ö
            const hasCoefficients = config.teamCoefficients && config.teamCoefficients.length > 0;
            const hasManagementFields = config.isManagementOnly;
            
            if (!hasCoefficients && !hasManagementFields) {
                coefficientsSection.style.display = 'none';
            } else {
                coefficientsSection.style.display = 'block';
                
                // –ò–∑–º–µ–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–æ–≥–æ NOP–° –µ—Å–ª–∏ –Ω–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
                if (hasManagementFields && !hasCoefficients) {
                    coefficientsTitle.textContent = 'üë• –ö–æ–º–∞–Ω–¥–Ω—ã–π –±–æ–Ω—É—Å';
                } else {
                    coefficientsTitle.textContent = '‚öôÔ∏è –ö–æ–º–∞–Ω–¥–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã';
                }
            }
        }

        function calculateKPICoefficient(percent, type) {
            if (type === 'revenue') {
                if (percent < 80) return 0;
                if (percent < 90) return 0.3;
                if (percent < 100) return 0.5;
                if (percent < 150) return percent / 100;
                return 1.5;
            } else {
                if (percent < 100) return 0;
                if (percent === 100) return 1;
                return Math.min(percent / 100, 1.2);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ –±–æ–Ω—É—Å–∞ –¥–ª—è –ü–í–ó WB (–æ–ø–µ—Ä–∞—Ü–∏—è 13) —Å–æ–≥–ª–∞—Å–Ω–æ —Ç–∞–±–ª–∏—Ü–µ
        function calculatePVZWBBonus(averageOrdersPerDay) {
            // –í—Ö–æ–¥–Ω–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä: —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–¥–∞–Ω–Ω—ã—Ö –≤ –ü–í–ó WB –∑–∞–∫–∞–∑–æ–≤ –≤ –¥–µ–Ω—å
            // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: –æ–±—â—É—é —Å—É–º–º—É –±–æ–Ω—É—Å–∞ (WB1 + WB2)
            
            let wb1 = 0; // –ß–∞—Å—Ç—å –∑–∞ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –ü–í–ó WB
            let wb2 = 0; // –ß–∞—Å—Ç—å –∑–∞ —Ä–µ–π—Ç–∏–Ω–≥ –ü–í–ó WB
            
            // –†–∞—Å—á–µ—Ç WB1 (—Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã) - –±–µ—Ä–µ–º —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
            if (averageOrdersPerDay <= 50) {
                wb1 = 0; // –ù–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–ª–∞–Ω–æ–≤—ã–º —Ä–µ–∂–∏–º–∞–º
            } else if (averageOrdersPerDay <= 100) {
                // –†–µ–∂–∏–º 1: 51-100 –∑–∞–∫–∞–∑–æ–≤
                wb1 = 1500; // –°—Ä–µ–¥–Ω–µ–µ –º–µ–∂–¥—É 1000-2000
            } else if (averageOrdersPerDay <= 166) {
                // –†–µ–∂–∏–º 1: 101-166 –∑–∞–∫–∞–∑–æ–≤  
                wb1 = 2500; // –°—Ä–µ–¥–Ω–µ–µ –º–µ–∂–¥—É 2000-3000
            } else {
                // –†–µ–∂–∏–º 1: 167+ –∑–∞–∫–∞–∑–æ–≤
                wb1 = 3000;
            }
            
            // –†–∞—Å—á–µ—Ç WB2 (—Ä–µ–π—Ç–∏–Ω–≥) - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ 4.95
            // –î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –±–µ—Ä–µ–º —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º —Ä–µ–π—Ç–∏–Ω–≥–µ
            if (averageOrdersPerDay <= 50) {
                wb2 = 0;
            } else if (averageOrdersPerDay <= 100) {
                wb2 = 2250; // –°—Ä–µ–¥–Ω–µ–µ –º–µ–∂–¥—É 1500-3000 –ø—Ä–∏ —Ä–µ–π—Ç–∏–Ω–≥–µ ‚â•4.9
            } else if (averageOrdersPerDay <= 166) {
                wb2 = 3750; // –°—Ä–µ–¥–Ω–µ–µ –º–µ–∂–¥—É 3000-4500 –ø—Ä–∏ —Ä–µ–π—Ç–∏–Ω–≥–µ ‚â•4.9
            } else {
                wb2 = 4500;
            }
            
            return wb1 + wb2; // –û–±—â–∏–π –±–æ–Ω—É—Å
        }

        function calculateTeamCoefficient(value, type) {
            if (type === 'service') {
                // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –°–µ—Ä–≤–∏—Å (CSI) - –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –æ–ø–µ—Ä–∞—Ü–∏—è–º —Ç–∏–ø–∞ 2
                if (value === 0) return 1.0; // –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω CSI, –±–∞–∑–æ–≤—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç
                if (value < 90) return 0.5;
                if (value < 95) return 1.0;
                return 1.5; // CSI >= 95 –±–∞–ª–ª–æ–≤
            } else if (type === 'speed_reception') {
                // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –°–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–∏–µ–º–∞ - –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –æ–ø–µ—Ä–∞—Ü–∏—è–º —Ç–∏–ø–∞ 3
                if (value < 100) return 0.5; // –ù–∏–∂–µ –ø–ª–∞–Ω–∞
                return 1.5; // –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç/–≤—ã—à–µ –ø–ª–∞–Ω–∞
            } else if (type === 'speed_delivery') {
                // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –°–∫–æ—Ä–æ—Å—Ç—å –≤—Ä—É—á–µ–Ω–∏—è - –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –æ–ø–µ—Ä–∞—Ü–∏—è–º —Ç–∏–ø–∞ 4
                if (value < 100) return 0.5; // –ù–∏–∂–µ –ø–ª–∞–Ω–∞
                return 1.5; // –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç/–≤—ã—à–µ –ø–ª–∞–Ω–∞
            } else if (type === 'efficiency') {
                // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –û–ü–° - –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –∏—Ç–æ–≥–æ–≤–æ–π –ø—Ä–µ–º–∏–∏
                if (value >= 100) return 1.3; // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ >= 100%
                return 1.0; // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ < 100%
            }
            return 1.0; // –ë–∞–∑–æ–≤—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç
        }

        function calculatePremium() {
            const selectedPosition = document.querySelector('input[name="position"]:checked').value;
            const config = POSITIONS_CONFIG[selectedPosition];
            
            // –†–∞—Å—á–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏ –ø–æ —Ç–∏–ø–∞–º
            let operationsBonus = 0;
            const operationsDetails = [];
            
            // –ü–æ–ª—É—á–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
            let serviceCoeff = 1.0;
            let speedReceptionCoeff = 1.0;
            let speedDeliveryCoeff = 1.0;
            let efficiencyCoeff = 1.0;
            
            // –ü–æ–ª—É—á–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∏–∑ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
            if (config.teamCoefficients) {
                config.teamCoefficients.forEach(coeffId => {
                    const input = document.getElementById(`coeff_${coeffId}`);
                    let value;
                    
                    if (coeffId === 'service') {
                        // CSI –≤ –±–∞–ª–ª–∞—Ö, –±–µ–∑ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
                        value = parseFloat(input.value) || 0;
                    } else {
                        // –û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
                        value = parseFloat(input.value) || 100;
                    }
                    
                    const coeff = TEAM_COEFFICIENTS_CONFIG[coeffId];
                    const coefficient = calculateTeamCoefficient(value, coeff.type);
                    
                    if (coeff.type === 'service') serviceCoeff = coefficient;
                    else if (coeff.type === 'speed_reception') speedReceptionCoeff = coefficient;
                    else if (coeff.type === 'speed_delivery') speedDeliveryCoeff = coefficient;
                    else if (coeff.type === 'efficiency') efficiencyCoeff = coefficient;
                });
            }
            
            config.operations.forEach(operationId => {
                const input = document.getElementById(`op_${operationId}`);
                const value = parseFloat(input.value) || 0;
                
                if (value > 0) {
                    const operation = OPERATIONS_CONFIG[operationId];
                    let operationValue = operation.value;
                    
                    // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–∏ 25 (—É—á–∞—Å—Ç–∏–µ –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö) - —Ä–∞–∑–Ω—ã–µ —Å—Ç–∞–≤–∫–∏
                    if (operationId === 25) {
                        if (selectedPosition === 'postman') {
                            operationValue = 13; // 13‚ÇΩ –¥–ª—è –ø–æ—á—Ç–∞–ª—å–æ–Ω–∞
                        } else {
                            operationValue = 10; // 10‚ÇΩ –¥–ª—è –ù–û–ü–° –∏ –¥—Ä—É–≥–∏—Ö
                        }
                    }
                    
                    // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–∏ 13 (–ü–í–ó WB) - —Å–ª–æ–∂–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞
                    if (operationId === 13) {
                        operationValue = calculatePVZWBBonus(value); // –°–ª–æ–∂–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø–æ —Ç–∞–±–ª–∏—Ü–µ
                    }
                    
                    let bonus;
                    if (operation.type === 'percent') {
                        bonus = value * operationValue;
                    } else if (operation.type === 'formula') {
                        bonus = operationValue; // –î–ª—è —Ñ–æ—Ä–º—É–ª operationValue —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Ç–æ–≥–æ–≤—É—é —Å—É–º–º—É
                    } else {
                        bonus = value * operationValue;
                    }
                    
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Å–æ–≥–ª–∞—Å–Ω–æ —Ç–∏–ø—É –æ–ø–µ—Ä–∞—Ü–∏–∏
                    let appliedCoeff = 1.0;
                    let coeffType = '';
                    
                    if (operation.operationType === 1) {
                        // –¢–∏–ø 1 - –±–µ–∑ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
                        appliedCoeff = 1.0;
                        coeffType = '–ë–µ–∑ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤';
                    } else if (operation.operationType === 2) {
                        // –¢–∏–ø 2 - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –°–µ—Ä–≤–∏—Å (CSI)
                        appliedCoeff = serviceCoeff;
                        coeffType = `CSI (√ó${appliedCoeff.toFixed(1)})`;
                    } else if (operation.operationType === 3) {
                        // –¢–∏–ø 3 - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –°–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–∏–µ–º–∞
                        appliedCoeff = speedReceptionCoeff;
                        coeffType = `–°–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–∏–µ–º–∞ (√ó${appliedCoeff.toFixed(1)})`;
                    } else if (operation.operationType === 4) {
                        // –¢–∏–ø 4 - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –°–∫–æ—Ä–æ—Å—Ç—å –≤—Ä—É—á–µ–Ω–∏—è
                        appliedCoeff = speedDeliveryCoeff;
                        coeffType = `–°–∫–æ—Ä–æ—Å—Ç—å –≤—Ä—É—á–µ–Ω–∏—è (√ó${appliedCoeff.toFixed(1)})`;
                    }
                    
                    const finalBonus = bonus * appliedCoeff;
                    operationsBonus += finalBonus;
                    
                    operationsDetails.push({
                        name: operation.name,
                        value: value,
                        unit: operation.unit,
                        bonus: finalBonus,
                        baseBonus: bonus,
                        coefficient: appliedCoeff,
                        coeffType: coeffType
                    });
                }
            });

            // –†–∞—Å—á–µ—Ç –ö–ü–ò
            let kpiBonus = 0;
            let revenuePercent = 100;
            const kpiDetails = [];
            let warningShown = false;

            config.kpi.forEach(kpiId => {
                const input = document.getElementById(`kpi_${kpiId}`);
                const value = parseFloat(input.value) || 0;
                
                if (value > 0) {
                    const percent = value;
                    let coefficient = calculateKPICoefficient(percent, kpiId);
                    
                    if (kpiId === 'revenue') {
                        revenuePercent = percent;
                        if (percent < 80) {
                            document.getElementById('warningCritical').style.display = 'block';
                            warningShown = true;
                        }
                    }
                    
                    const bonus = coefficient * 5000; // –ë–∞–∑–æ–≤–∞—è —Å—É–º–º–∞ –ö–ü–ò
                    kpiBonus += bonus;
                    
                    kpiDetails.push({
                        name: KPI_CONFIG[kpiId].name,
                        percent: percent.toFixed(1),
                        coefficient: coefficient,
                        bonus: bonus
                    });
                }
            });

            if (!warningShown) {
                document.getElementById('warningCritical').style.display = 'none';
            }

            // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ 80% (—Ç–æ–ª—å–∫–æ –¥–ª—è –ö–ü–ò, –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç—Å—è)
            if (revenuePercent < 80) {
                kpiBonus = 0;
                kpiDetails.forEach(detail => {
                    detail.bonus = 0;
                    detail.coefficient = 0;
                });
            }

            // –ö–æ–º–∞–Ω–¥–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã (–¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è)
            const coefficientsDetails = [];

            if (config.teamCoefficients) {
                config.teamCoefficients.forEach(coeffId => {
                    const input = document.getElementById(`coeff_${coeffId}`);
                    const value = parseFloat(input.value) || 0;
                    
                    if (value > 0) {
                        const coeff = TEAM_COEFFICIENTS_CONFIG[coeffId];
                        const coefficient = calculateTeamCoefficient(value, coeff.type);
                        
                        coefficientsDetails.push({
                            name: coeff.name,
                            value: value,
                            coefficient: coefficient
                        });
                    }
                });
            }

            // –û–ø–µ—Ä–∞—Ü–∏–∏ —É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏
            const adjustedOperationsBonus = operationsBonus;

            // –ö–æ–º–∞–Ω–¥–Ω—ã–π –±–æ–Ω—É—Å
            let teamBonus = 0;
            if (config.hasTeamBonus) {
                if (config.isManagementOnly) {
                    // –î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–æ–≥–æ –ù–û–ü–° - –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –ø—Ä–µ–º–∏–π –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã—Ö
                    const subordinatesInput = document.getElementById('subordinates_bonus');
                    const subordinatesBonus = parseFloat(subordinatesInput?.value) || 0;
                    teamBonus = subordinatesBonus * 0.03; // 3% –æ—Ç –ø—Ä–µ–º–∏–π –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã—Ö
                } else {
                    // –î–ª—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –ù–û–ü–° - —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç
                    teamBonus = adjustedOperationsBonus * 0.03;
                }
            }

            // –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–µ–º–∏—è —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –û–ü–°
            // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ù–ï –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ NOPS –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É (—É –Ω–∏—Ö –µ—Å—Ç—å –ö–ü–ò)
            const totalBeforeEfficiency = adjustedOperationsBonus + kpiBonus + teamBonus;
            const hasKPI = config.kpi && config.kpi.length > 0;
            const totalPremium = hasKPI ? totalBeforeEfficiency : (totalBeforeEfficiency * efficiencyCoeff);

            displayResults({
                operationsBonus: adjustedOperationsBonus,
                operationsDetails,
                kpiBonus,
                kpiDetails,
                teamBonus,
                totalPremium,
                position: config.name,
                revenuePercent,
                coefficientsDetails,
                serviceCoeff,
                speedReceptionCoeff,
                speedDeliveryCoeff,
                efficiencyCoeff,
                hasKPI
            });
        }

        function displayResults(results) {
            const container = document.getElementById('resultsContent');
            let html = '';
            
            if (results.operationsDetails.length > 0) {
                html += '<div class="result-item"><span>üíº –ë–æ–Ω—É—Å –∑–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏:</span><span>' + 
                        formatMoney(results.operationsBonus) + '</span></div>';
                
                results.operationsDetails.forEach(detail => {
                    const coeffDisplay = detail.coefficient !== 1.0 ? ` ‚Ä¢ ${detail.coeffType}` : '';
                    html += '<div class="result-item" style="font-size: 0.9rem; padding: 8px 0;"><span>  ‚Ä¢ ' + 
                            detail.name + ' (' + detail.value + ' ' + detail.unit + ')' + coeffDisplay + ':</span><span>' + 
                            formatMoney(detail.bonus) + '</span></div>';
                });
            }

            if (results.kpiDetails.length > 0) {
                html += '<div class="result-item"><span>üìä –ë–æ–Ω—É—Å –∑–∞ –ö–ü–ò:</span><span>' + 
                        formatMoney(results.kpiBonus) + '</span></div>';
                
                results.kpiDetails.forEach(detail => {
                    html += '<div class="result-item" style="font-size: 0.9rem; padding: 8px 0;"><span>  ‚Ä¢ ' + 
                            detail.name + ' (' + detail.percent + '%, –∫=' + detail.coefficient.toFixed(2) + '):</span><span>' + 
                            formatMoney(detail.bonus) + '</span></div>';
                });
            }

            if (results.teamBonus > 0) {
                const bonusLabel = results.position.includes('—Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏') ? 
                    'üë• –ö–æ–º–∞–Ω–¥–Ω—ã–π –±–æ–Ω—É—Å (3% –æ—Ç –ø—Ä–µ–º–∏–π –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã—Ö):' : 
                    'üë• –ö–æ–º–∞–Ω–¥–Ω—ã–π –±–æ–Ω—É—Å –ù–û–ü–° (3%):';
                html += '<div class="result-item"><span>' + bonusLabel + '</span><span>' + 
                        formatMoney(results.teamBonus) + '</span></div>';
            }

            // –ö–æ–º–∞–Ω–¥–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
            if (results.coefficientsDetails && results.coefficientsDetails.length > 0) {
                html += '<div class="result-item"><span>‚öôÔ∏è –ö–æ–º–∞–Ω–¥–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã:</span><span></span></div>';
                
                results.coefficientsDetails.forEach(detail => {
                    const valueDisplay = detail.name.includes('CSI') ? 
                        `${detail.value} –±–∞–ª–ª–æ–≤` : 
                        `${detail.value}%`;
                    html += '<div class="result-item" style="font-size: 0.9rem; padding: 8px 0;"><span>  ‚Ä¢ ' + 
                            detail.name + ' (' + valueDisplay + '):</span><span>K = ' + 
                            detail.coefficient.toFixed(1) + '</span></div>';
                });

                // –ò—Ç–æ–≥–æ–≤—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –û–ü–° (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è)
                if (results.efficiencyCoeff !== 1.0 && !results.hasKPI) {
                    html += '<div class="result-item" style="font-size: 0.9rem; padding: 8px 0;"><span>  ‚Ä¢ –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –û–ü–°:</span><span>K = ' + 
                            results.efficiencyCoeff.toFixed(1) + '</span></div>';
                }
            }

            html += '<div class="result-item"><span>üèÜ –ò–¢–û–ì–û –ü–†–ï–ú–ò–Ø:</span><span>' + 
                    formatMoney(results.totalPremium) + '</span></div>';

            container.innerHTML = html;
        }

        function formatMoney(amount) {
            return new Intl.NumberFormat('ru-RU').format(Math.round(amount)) + ' ‚ÇΩ';
        }
    </script>
</body>
</html> 